<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Boat Race Tracks - QueasyBoatRaces</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }

        #map-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: auto;
            cursor: move;
            background-color: #fff;
        }

        .grid-container {
            position: relative;
            width: 4000px;
            height: 4000px;
        }

        .grid-line {
            position: absolute;
            background-color: rgba(50,50,50,.1);
        }

        .grid-line.vertical {
            width: 1px;
            height: 100%;
        }

        .grid-line.horizontal {
            height: 1px;
            width: 100%;
        }

        .grid-line.major {
            background-color: rgba(50,50,50,.3);
            z-index: 1;
        }

        .track-point {
            position: absolute;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .track-point:hover {
            transform: translate(-50%, -50%) scale(1.1);
            z-index: 1000;
        }

        .track-image {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            border: 3px solid #4CAF50;
            object-fit: cover;
        }

        .track-name {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 2000;
        }

        .modal-content {
            position: relative;
            background-color: white;
            margin: auto;
            padding: 20px;
            width: 70%;
            max-width: 700px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            position: absolute;
            right: 10px;
            top: 5px;
            font-size: 24px;
            cursor: pointer;
        }

        .coordinates-display {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-family: monospace;
            z-index: 1000;
        }

        .center-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: rgba(255, 0, 0, 0.5);
            border: 2px solid red;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 10;
        }

        .center-marker::after {
            content: '[0,0]';
            position: absolute;
            top: 25px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            color: red;
            z-index: 10;
        }

        .axis-label {
            position: absolute;
            font-size: 12px;
            color: rgba(50,50,50,0.7);
            font-weight: bold;
            z-index: 5;
        }

        .stat-bar-container {
            margin: 15px 0;
            width: 100%;
        }

        .stat-bar-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2px;
            font-weight: bold;
        }

        .stat-bar-value {
            font-weight: normal;
            color: #666;
        }

        .stat-bar-background {
            width: 100%;
            height: 20px;
            background-color: #eee;
            border-radius: 10px;
            overflow: hidden;
        }

        .stat-bar-fill {
            height: 100%;
            transition: width 0.5s ease-out, background-color 0.5s ease-out;
            border-radius: 10px;
        }

        .separator {
            border-top: 2px solid #ddd;
            margin: 10px 0;
        }

        .user-info {
            position: fixed;
            top: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-family: monospace;
            z-index: 1000;
        }

        .log-indicator {
            font-size: 10px;
            color: #999;
            margin-left: 5px;
        }
    </style>
</head>
<body>
    <div id="map-container">
        <div class="grid-container">
            <div class="center-marker"></div>
        </div>
    </div>
    <div class="coordinates-display" id="coordinates">0, 0</div>
    <div class="user-info">
        <div>User: QueasyBoatRaces</div>
        <div>UTC: 2025-08-12 16:31:36</div>
    </div>

    <div id="trackModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modalTrackName"></h2>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        const CURRENT_USER = 'QueasyBoatRaces';
        const CURRENT_DATE = new Date('2025-08-12T16:31:36Z');

        const tracks = [
            {
                position: [1, 0],
                name: "Rainbow Road",
                averageTime: 3.5,
                length: 8.4,
                width: 21,
                difficulty: 4,
                averageSpeed: 210,
                releaseDate: "2024-07-21",
                worldRecord: "3:16.00",
                staffBest: 196.0,
                image: "rainbowroad.jpg",
                worldDownload: "rainbowroad.zip",
                servers: []
            },
            {
                position: [0, -2],
                name: "The path of the devil",
                averageTime: 20,
                length: 30,
                width: 9,
                difficulty: 5,
                averageSpeed: 150,
                releaseDate: "2025-02-18",
                worldRecord: "15:51.20",
                staffBest: 951.2,
                image: "pathofthedevil.jpg",
                worldDownload: "pathofthedevil.zip",
                servers: []
            },
            {
                position: [-2,0],
                name: "The labyrinth of nightmares",
                averageTime: 2.5,
                length: 6.5,
                width: 15,
                difficulty: 4,
                averageSpeed: 250,
                releaseDate: "2025-03-23",
                worldRecord: "2:05.00",
                staffBest: 127.0,
                image: "labyrinthofnightmares.jpg",
                worldDownload: "labyrinthofnightmares.zip",
                servers: ["frosthex.com"]
            },
            {
                position: [-1, 0],
                name: "Space Road",
                averageTime: 5,
                length: 16,
                width: 25,
                difficulty: 4,
                averageSpeed: 280,
                releaseDate: "2025-05-07",
                worldRecord: "4:36.80",
                staffBest: 276.80,
                image: "spaceroad.jpg",
                worldDownload: "spaceroad.zip",
                servers: []
            },
            {
                position: [0, 1],
                name: "Titanic Monarch",
                averageTime: 6,
                length: 16,
                width: 15,
                difficulty: 4,
                averageSpeed: 230,
                releaseDate: "2025-05-23",
                worldRecord: "6:09.00",
                staffBest: 369.0,
                image: "titanicmonarch.jpg",
                worldDownload: "titanicmonarch.zip",
                servers: []
            },
            {
                position: [2, 0],
                name: "Broken Rainbow Road",
                averageTime: 3,
                length: 7.6,
                width: 19,
                difficulty: 4,
                averageSpeed: 230,
                releaseDate: "2025-06-08",
                worldRecord: "2:43.00",
                staffBest: 163.0,
                image: "brokenrainbowroad.jpg",
                worldDownload: "brokenrainbowroad.zip",
                servers: []
            },
            {
                position: [0, -1],
                name: "Through the fire and flames",
                averageTime: 7,
                length: 26,
                width: 17,
                difficulty: 5,
                averageSpeed: 300,
                releaseDate: "2025-07-25",
                worldRecord: "7:06.00",
                staffBest: 426.0,
                image: "throughthefireandflames.jpg",
                worldDownload: "throughthefireandflames.zip",
                servers: []
            },
            {
                position: [0, 2],
                name: "Metallic madness",
                averageTime: 10,
                length: 23,
                width: 17,
                difficulty: 4,
                averageSpeed: 200,
                releaseDate: "2025-01-15",
                worldRecord: "10:12.00",
                staffBest: 612.0,
                image: "metallicmadness.jpg",
                worldDownload: "metallicmadness.zip",
                servers: []
            },
            {
                position: [-1, 1],
                name: "Stardust Speedway",
                averageTime: 15,
                length: 50,
                width: 19,
                difficulty: 4,
                averageSpeed: 270,
                releaseDate: "2025-01-15",
                worldRecord: "15:02.00",
                staffBest: 902.0,
                image: "stardustspeedway.jpg",
                worldDownload: "stardustspeedway.zip",
                servers: []
            },
            {
                position: [0, 0],
                name: "Mystic Road",
                averageTime: 80,
                length: 210,
                width: 19,
                difficulty: 5,
                averageSpeed: 230,
                releaseDate: "2025-08-21",
                worldRecord: "77:07.65",
                staffBest: 4627.65,
                image: "mysticroad.jpg",
                worldDownload: "mysticroad.zip",
                servers: []
            }
        ];

        function getColorForPercentage(percentage) {
            percentage = Math.max(0, Math.min(100, percentage));
            
            const colorStops = [
                { percent: 0, color: { r: 33, g: 150, b: 243 } },    // Blue (#2196F3)
                { percent: 33, color: { r: 76, g: 175, b: 80 } },    // Green (#4CAF50)
                { percent: 66, color: { r: 255, g: 193, b: 7 } },    // Yellow (#FFC107)
                { percent: 100, color: { r: 244, g: 67, b: 54 } }    // Red (#F44336)
            ];
            
            let startColor, endColor;
            let startPercent, endPercent;
            
            for (let i = 0; i < colorStops.length - 1; i++) {
                if (percentage >= colorStops[i].percent && percentage <= colorStops[i + 1].percent) {
                    startColor = colorStops[i].color;
                    endColor = colorStops[i + 1].color;
                    startPercent = colorStops[i].percent;
                    endPercent = colorStops[i + 1].percent;
                    break;
                }
            }
            
            const range = endPercent - startPercent;
            const percentInRange = (percentage - startPercent) / range;
            
            const r = Math.round(startColor.r + (endColor.r - startColor.r) * percentInRange);
            const g = Math.round(startColor.g + (endColor.g - startColor.g) * percentInRange);
            const b = Math.round(startColor.b + (endColor.b - startColor.b) * percentInRange);
            
            return `rgb(${r}, ${g}, ${b})`;
        }

        function formatRelativeTime(dateString) {
            const date = new Date(dateString);
            const diffTime = Math.abs(CURRENT_DATE - date);
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) return 'Today';
            if (diffDays === 1) return 'Yesterday';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
            if (diffDays < 365) return `${Math.floor(diffDays / 30)} months ago`;
            return `${Math.floor(diffDays / 365)} years ago`;
        }

        function formatTime(time) {
            if (typeof time === 'string') return time;
            const minutes = Math.floor(time / 60);
            const seconds = (time % 60).toFixed(2);
            return `${minutes}:${seconds.padStart(5, '0')}`;
        }

        function calculateScaledPercentage(value, minValue, maxValue, useLog = false) {
            if (value <= minValue) return 0;
            
            if (useLog) {
                const logValue = Math.log10(value);
                const logMin = Math.log10(minValue);
                const logMax = Math.log10(maxValue);
                return Math.min(((logValue - logMin) / (logMax - logMin)) * 100, 100);
            } else {
                return Math.min(((value - minValue) / (maxValue - minValue)) * 100, 100);
            }
        }

        function createStatBar(label, value, minValue, maxValue, unit = '', options = {}) {
            const {
                reverseColor = false,
                showPercentage = false,
                customFormat = null,
                useLog = false
            } = options;
            
            const percentage = calculateScaledPercentage(value, minValue, maxValue, useLog);
            const colorPercentage = reverseColor ? 100 - percentage : percentage;
            const color = getColorForPercentage(colorPercentage);
            
            const displayValue = customFormat ? customFormat(value) : `${value}${unit}`;
            const percentageDisplay = showPercentage ? ` (${Math.round(percentage)}%)` : '';
            const logIndicator = useLog ? '<span class="log-indicator">log</span>' : '';
            
            return `
                <div class="stat-bar-container">
                    <div class="stat-bar-label">
                        <span>${label}${logIndicator}</span>
                        <span class="stat-bar-value">${displayValue}${percentageDisplay}</span>
                    </div>
                    <div class="stat-bar-background">
                        <div class="stat-bar-fill" style="width: ${percentage}%; background-color: ${color};"></div>
                    </div>
                </div>
                <div class="separator"></div>
            `;
        }

        function showTrackDetails(track) {
            const modal = document.getElementById('trackModal');
            const modalTrackName = document.getElementById('modalTrackName');
            const modalContent = document.getElementById('modalContent');

            // Define min and max values with more realistic ranges
            const statRanges = {
                time: { min: 2, max: 30, useLog: true }, // Adjusted max to make Path of the Devil show ~90%
                length: { min: 5, max: 80, useLog: true }, // Adjusted max to make Stardust Speedway show ~90%
                width: { min: 8, max: 25 },
                difficulty: { min: 1, max: 5 },
                speed: { min: 100, max: 300 }
            };

            modalTrackName.textContent = track.name;
            
            modalContent.innerHTML = `
                <img src="${track.image}" alt="${track.name}" style="max-width: 300px; margin-bottom: 20px;">
                <p><strong>Position:</strong> [${track.position.join(', ')}]</p>
                
                <h3>${track.name}</h3>
                ${createStatBar('Average Time', track.averageTime, statRanges.time.min, statRanges.time.max, ' min', { 
                    reverseColor: true,
                    customFormat: (val) => `${val} min (${(val * 60).toFixed(0)}s)`,
                    useLog: statRanges.time.useLog
                })}
                ${createStatBar('Length', track.length, statRanges.length.min, statRanges.length.max, ' km', {
                    useLog: statRanges.length.useLog
                })}
                ${createStatBar('Width', track.width, statRanges.width.min, statRanges.width.max, ' blocks')}
                ${createStatBar('Difficulty', track.difficulty, statRanges.difficulty.min, statRanges.difficulty.max, ' ★')}
                ${createStatBar('Average Speed', track.averageSpeed, statRanges.speed.min, statRanges.speed.max, ' cm/t', {
                    customFormat: (val) => `${val} cm/t (${(val * 72 / 100).toFixed(1)} km/h)`
                })}
                
                <div style="margin-top: 20px;">
                    <p><strong>Release Date:</strong> ${track.releaseDate} (${formatRelativeTime(track.releaseDate)})</p>
                    <p><strong>World Record:</strong> ${formatTime(track.worldRecord)}</p>
                    <p><strong>Staff Best:</strong> ${formatTime(track.staffBest)}</p>
                    <p><strong>World Download:</strong> <a href="${track.worldDownload}" target="_blank">${track.worldDownload}</a></p>
                    ${track.servers.length ? `<p><strong>Available on Servers:</strong> ${track.servers.join(', ')}</p>` : ''}
                </div>
            `;

            modal.style.display = 'block';
        }

        function createGrid() {
            const gridContainer = document.querySelector('.grid-container');
            const GRID_SIZE = 50;
            const GRID_EXTENT = 40; // -40 to +40 range
            const containerSize = (GRID_EXTENT * 2 + 1) * GRID_SIZE;
            
            // Set container size
            gridContainer.style.width = `${containerSize}px`;
            gridContainer.style.height = `${containerSize}px`;
            
            // Create vertical lines
            for (let x = -GRID_EXTENT; x <= GRID_EXTENT; x++) {
                const line = document.createElement('div');
                line.className = `grid-line vertical ${x % 5 === 0 ? 'major' : ''}`;
                line.style.left = `${(x + GRID_EXTENT) * GRID_SIZE}px`;
                gridContainer.appendChild(line);
                
                // Add labels for major lines
                if (x % 5 === 0) {
                    const label = document.createElement('div');
                    label.className = 'axis-label';
                    label.textContent = x.toString();
                    label.style.left = `${(x + GRID_EXTENT) * GRID_SIZE - 10}px`;
                    label.style.top = `${GRID_EXTENT * GRID_SIZE + 25}px`;
                    gridContainer.appendChild(label);
                }
            }
            
            // Create horizontal lines
            for (let y = -GRID_EXTENT; y <= GRID_EXTENT; y++) {
                const line = document.createElement('div');
                line.className = `grid-line horizontal ${y % 5 === 0 ? 'major' : ''}`;
                line.style.top = `${(GRID_EXTENT - y) * GRID_SIZE}px`;
                gridContainer.appendChild(line);
                
                // Add labels for major lines
                if (y % 5 === 0 && y !== 0) {
                    const label = document.createElement('div');
                    label.className = 'axis-label';
                    label.textContent = y.toString();
                    label.style.left = `${GRID_EXTENT * GRID_SIZE + 10}px`;
                    label.style.top = `${(GRID_EXTENT - y) * GRID_SIZE - 6}px`;
                    gridContainer.appendChild(label);
                }
            }
        }

        function createTrackPoint(track) {
            const gridContainer = document.querySelector('.grid-container');
            const point = document.createElement('div');
            point.className = 'track-point';
            
            const img = document.createElement('img');
            img.src = track.image;
            img.className = 'track-image';
            img.alt = track.name;
            
            const name = document.createElement('div');
            name.className = 'track-name';
            name.textContent = track.name;
            
            point.appendChild(img);
            point.appendChild(name);
            
            updateTrackPosition(point, track.position[0], track.position[1]);
            
            point.addEventListener('click', () => showTrackDetails(track));
            gridContainer.appendChild(point);
            return point;
        }

        function updateTrackPosition(element, x, y) {
            const GRID_SIZE = 50;
            const GRID_EXTENT = 40;
            const centerX = GRID_EXTENT * GRID_SIZE;
            const centerY = GRID_EXTENT * GRID_SIZE;
            element.style.left = `${centerX + (x * GRID_SIZE)}px`;
            element.style.top = `${centerY - (y * GRID_SIZE)}px`;
        }

        const mapContainer = document.getElementById('map-container');
        const coordDisplay = document.getElementById('coordinates');

        // Update coordinates based on scroll position
        function updateCoordinates() {
            const GRID_SIZE = 50;
            const GRID_EXTENT = 40;
            const centerX = GRID_EXTENT * GRID_SIZE;
            const centerY = GRID_EXTENT * GRID_SIZE;
            
            const scrollX = mapContainer.scrollLeft;
            const scrollY = mapContainer.scrollTop;
            const viewportCenterX = scrollX + mapContainer.clientWidth / 2;
            const viewportCenterY = scrollY + mapContainer.clientHeight / 2;
            
            const gridX = Math.round((viewportCenterX - centerX) / GRID_SIZE);
            const gridY = Math.round(-(viewportCenterY - centerY) / GRID_SIZE);
            
            coordDisplay.textContent = `${gridX}, ${gridY}`;
        }

        mapContainer.addEventListener('scroll', updateCoordinates);

        // Center the view on [0,0] initially
        function centerView() {
            const GRID_SIZE = 50;
            const GRID_EXTENT = 40;
            const centerX = GRID_EXTENT * GRID_SIZE;
            const centerY = GRID_EXTENT * GRID_SIZE;
            
            mapContainer.scrollLeft = centerX - mapContainer.clientWidth / 2;
            mapContainer.scrollTop = centerY - mapContainer.clientHeight / 2;
            updateCoordinates();
        }

        document.querySelector('.close').addEventListener('click', () => {
            document.getElementById('trackModal').style.display = 'none';
        });

        window.addEventListener('click', (event) => {
            const modal = document.getElementById('trackModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        });

        // Initialize everything
        createGrid();
        tracks.forEach(track => createTrackPoint(track));
        
        // Center the view when page loads
        window.addEventListener('load', () => {
            setTimeout(centerView, 100);
        });
    </script>
</body>
</html>
